
/* Query 1 - Used to get the sale per unit per genre and percentage of sale */

SELECT	*, 
	(
	SELECT PRINTF("%.2f",(PRINTF("%.2f",sale_per_genre*100))/SUM(quantity)) 
	FROM invoiceline
	)  AS percent
FROM	
	(
	SELECT g.name AS genre, COUNT(*) AS  sale_per_genre
	FROM Track t
	JOIN Genre g ON T.genreId = G.genreId
	Join InvoiceLine il ON il.TrackId = t.TrackId
	GROUP BY 1
	ORDER BY 2 DESC
	);